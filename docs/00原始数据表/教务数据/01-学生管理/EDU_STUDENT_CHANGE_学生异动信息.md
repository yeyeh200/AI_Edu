# EDU_STUDENT_CHANGE 学生异动信息表

## 基本信息

- **表名**：`EDU_STUDENT_CHANGE`（原表名：`V_BRW_StudChange`）
- **中文名称**：学生异动信息
- **用途**：记录学生学籍异动信息，包括转学、休学、复学、退学等学籍变更的详细记录
- **字段数量**：22个
- **数据类别**：教务系统 - 学生管理模块

## 字段定义

| 字段名 | 原字段名 | 数据类型 | 长度 | 是否为空 | 主键 | 默认值 | 备注 |
|--------|----------|----------|------|----------|------|--------|------|
| xn | 学年 | char | - | NO | YES | - | 如，2009表示2009-2010学年 |
| xq_id | 学期 | char | - | NO | YES | - | 0第一学期，1第二学期，2第三学期 |
| user_xh | 学号 | char | - | NO | YES | - | 学生唯一标识 |
| xm | 姓名 | char | - | YES | NO | - | - |
| ydlb | 异动类别 | char | - | NO | YES | - | - |
| y_nj | 异动前年级 | char | - | YES | NO | - | - |
| y_yxbmc | 异动前院(系)/部名称 | char | - | YES | NO | - | - |
| y_zymc | 异动前专业名称 | char | - | YES | NO | - | - |
| y_bjmc | 异动前班级名称 | char | - | YES | NO | - | - |
| y_userbjdm | 异动前班级代码 | char | - | YES | NO | - | - |
| y_xjzt | 异动前学籍状态 | char | - | YES | NO | - | 1有，0无 |
| y_sfzx | 异动前是否在校 | char | - | YES | NO | - | 1是，0否 |
| nj | 异动后年级 | char | - | YES | NO | - | - |
| yxbmc | 异动后院(系)/部名称 | char | - | YES | NO | - | - |
| zymc | 异动后专业名称 | char | - | YES | NO | - | - |
| bjmc | 异动后班级名称 | char | - | YES | NO | - | - |
| userbjdm | 异动后班级代码 | char | - | YES | NO | - | - |
| xjzt | 异动后学籍状态 | char | - | YES | NO | - | 1有，0无 |
| sfzx | 异动后是否在校 | char | - | YES | NO | - | 1是，0否 |
| ydyy | 异动原因 | char | - | YES | NO | - | - |
| ydwh | 异动文号 | char | - | YES | NO | - | - |
| ydsm | 异动说明 | char | - | YES | NO | - | - |
| ydrq | 异动日期 | datetime | - | YES | NO | - | - |

## 字段详细说明

### 主键字段
- **xn**：学年，如2009表示2009-2010学年
- **xq_id**：学期标识（0第一学期，1第二学期，2第三学期）
- **user_xh**：学生学号，唯一标识学生
- **ydlb**：异动类别，标识异动类型

### 学生基本信息
- **xm**：学生姓名

### 异动前信息字段
- **y_nj**：异动前年级
- **y_yxbmc**：异动前院(系)/部名称
- **y_zymc**：异动前专业名称
- **y_bjmc**：异动前班级名称
- **y_userbjdm**：异动前班级代码
- **y_xjzt**：异动前学籍状态（1有，0无）
- **y_sfzx**：异动前是否在校（1是，0否）

### 异动后信息字段
- **nj**：异动后年级
- **yxbmc**：异动后院(系)/部名称
- **zymc**：异动后专业名称
- **bjmc**：异动后班级名称
- **userbjdm**：异动后班级代码
- **xjzt**：异动后学籍状态（1有，0无）
- **sfzx**：异动后是否在校（1是，0否）

### 异动详情字段
- **ydyy**：异动原因
- **ydwh**：异动文号
- **ydsm**：异动说明
- **ydrq**：异动日期

## 异动类别说明

| 异动类别 | 说明 | 常见原因 |
|----------|------|----------|
| 01 | 转入 | 从其他学校转入 |
| 02 | 转出 | 转到其他学校 |
| 03 | 休学 | 因故暂停学习 |
| 04 | 复学 | 休学后恢复学习 |
| 05 | 退学 | 自愿或强制终止学业 |
| 06 | 升级 | 升入高年级 |
| 07 | 降级 | 降至低年级 |
| 08 | 转专业 | 更换专业 |
| 09 | 转班级 | 更换班级 |
| 10 | 毕业 | 完成学业 |
| 11 | 结业 | 完成部分学业 |
| 12 | 肆业 | 非正常完成学业 |
| 99 | 其他 | 其他异动类型 |

## 数据约束

1. **复合主键约束**：通常由 `(xn, xq_id, user_xh, ydlb)` 组成复合主键
2. **外键约束**：`user_xh` 应引用学生基本信息表中的有效记录
3. **外键约束**：`y_userbjdm` 和 `userbjdm` 应引用班级表中的有效记录
4. **检查约束**：`y_xjzt` 和 `xjzt` 只能是 0 或 1
5. **检查约束**：`y_sfzx` 和 `sfzx` 只能是 0 或 1
6. **检查约束**：`xq_id` 只能是 0、1 或 2

## 索引建议

- **复合主键索引**：`(xn, xq_id, user_xh, ydlb)` - 主键索引
- **学号索引**：`user_xh` - 用于查询学生所有异动记录
- **异动类别索引**：`ydlb` - 用于按异动类型统计
- **时间索引**：`ydrq` - 用于按异动时间查询
- **学期索引**：`xn, xq_id` - 用于按学期查询异动情况

## 数据关联关系

### 主要外键关联
- **学生基本信息表**：通过 `user_xh` 关联学生基本信息
- **班级信息表**：通过 `y_userbjdm` 和 `userbjdm` 关联班级信息

### 业务关联
- 与 **学生状态表**关联：反映异动对学生状态的影响
- 与 **异动申请表**关联：记录异动申请的详细信息
- 与 **课程安排表**关联：影响学生的选课和上课安排

## 使用示例

### SQL查询示例

```sql
-- 查询某学生所有异动记录
SELECT xn, xq_id, ydlb, y_yxbmc, y_zymc, y_bjmc,
       yxbmc, zymc, bjmc, ydyy, ydrq
FROM EDU_STUDENT_CHANGE
WHERE user_xh = '2024001001'
ORDER BY ydrq DESC;

-- 查询某学期休学学生
SELECT s.user_xh, s.xm, c.y_yxbmc, c.y_zymc, c.y_bjmc,
       c.ydyy, c.ydrq
FROM EDU_STUDENT_CHANGE c
JOIN EDU_STUDENT_INFO s ON c.user_xh = s.user_xh
WHERE c.xn = '2024' AND c.xq_id = '0' AND c.ydlb = '03'
ORDER BY c.ydrq;

-- 查询转专业学生统计
SELECT c.y_zymc AS from_major, c.zymc AS to_major,
       COUNT(*) as transfer_count
FROM EDU_STUDENT_CHANGE c
WHERE c.ydlb = '08'
GROUP BY c.y_zymc, c.zymc
ORDER BY transfer_count DESC;

-- 查询异动原因统计
SELECT ydlb, ydyy, COUNT(*) as count
FROM EDU_STUDENT_CHANGE
GROUP BY ydlb, ydyy
ORDER BY count DESC;
```

### 数据插入示例

```sql
INSERT INTO EDU_STUDENT_CHANGE (
    xn, xq_id, user_xh, xm, ydlb,
    y_yxbmc, y_zymc, y_bjmc, y_userbjdm, y_xjzt, y_sfzx,
    yxbmc, zymc, bjmc, userbjdm, xjzt, sfzx,
    ydyy, ydwh, ydrq
) VALUES (
    '2024', '0', '2024001001', '张三', '08',
    '计算机学院', '软件工程', '软件2024-1班', 'SE202401', '1', '1',
    '信息学院', '计算机科学', '计算机2024-2班', 'CS202402', '1', '1',
    '专业调整', '教务处字[2024]01号', '2024-03-01 00:00:00'
);
```

## 业务逻辑说明

### 异动流程
1. **申请阶段**：学生提交异动申请
2. **审核阶段**：相关部门审核异动申请
3. **批准阶段**：批准后执行异动操作
4. **记录阶段**：在异动表中记录详细信息
5. **更新阶段**：更新学生基本信息和状态

### 数据完整性
1. **异动前后对比**：完整记录异动前后的所有信息
2. **状态同步**：异动后及时更新学生状态
3. **历史追溯**：保留完整的异动历史记录

### 异动类型处理
1. **转入转出**：涉及学籍的转入和转出
2. **休学复学**：临时中断和恢复学习
3. **专业调整**：学生专业和班级的变更
4. **学籍终止**：毕业、退学、结业等最终状态

## 数据维护建议

### 定期维护
1. **数据校验**：检查异动记录的完整性和准确性
2. **状态同步**：确保异动后学生状态的正确更新
3. **历史归档**：定期归档历史异动记录

### 异常处理
1. **重复记录**：检查并处理重复的异动记录
2. **缺失记录**：补充遗漏的异动记录
3. **状态冲突**：处理异动后状态不一致的情况

## 常见异动场景

### 学期内异动
- **转专业**：学生申请更换专业
- **转班级**：因各种原因更换班级
- **休学**：因健康、经济等原因暂停学习

### 学期间异动
- **复学**：休学期满后恢复学习
- **升级/降级**：学习进度的调整
- **转入/转出**：学校之间的学籍转移

### 学业结束异动
- **毕业**：完成所有学业要求
- **退学**：各种原因提前终止学业
- **结业/肄业**：部分完成学业

---

**数据来源**：教务管理系统
**维护单位**：学生管理科
**更新频率**：异动发生时实时更新