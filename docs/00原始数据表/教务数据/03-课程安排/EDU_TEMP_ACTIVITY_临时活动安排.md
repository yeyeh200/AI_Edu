# EDU_TEMP_ACTIVITY 临时活动安排表

## 基本信息

- **表名**：`EDU_TEMP_ACTIVITY`（原表名：`V_BRW_Schedule_LSHD`）
- **中文名称**：临时活动安排
- **用途**：存储临时活动安排信息，包括学术讲座、学生活动、会议等临时占用的教室和时间
- **字段数量**：13个
- **数据类别**：教务系统 - 课程安排模块

## 字段定义

| 字段名 | 原字段名 | 数据类型 | 长度 | 是否为空 | 主键 | 默认值 | 备注 |
|--------|----------|----------|------|----------|------|--------|------|
| xn | 学年 | char | - | NO | YES | - | 如，2009表示2009-2010学年 |
| xq_id | 学期 | char | - | NO | YES | - | 0第一学期，1第二学期，2第三学期 |
| hdmc | 活动名称 | char | - | YES | NO | - | - |
| hdnr | 活动内容 | char | - | YES | NO | - | - |
| skbj | 活动代号 | char | - | NO | YES | - | - |
| stimezc | 周次 | char | - | YES | NO | - | 如：1-5,8-18 |
| dsz | 单双周 | char | - | YES | NO | - | 1单周，2双周，0全周 |
| jcinfo | 节次 | char | - | YES | NO | - | 如：1-2 |
| jcz | 大节 | char | - | YES | NO | - | kxy格式，如K12表示星期一第二大节 |
| room_DM | 活动地点代码 | char | - | YES | NO | - | - |
| room | 活动地点 | char | - | YES | NO | - | - |
| Analyse | 周次分析 | char | - | YES | NO | - | - |
| JCAnalyse | 节次分析 | char | - | YES | NO | - | - |

## 字段详细说明

### 主键字段
- **xn**：学年，主键组成部分
- **xq_id**：学期，主键组成部分
- **skbj**：活动代号，主键组成部分

### 活动基本信息
- **hdmc**：活动名称，临时活动的名称
- **hdnr**：活动内容，活动的详细内容描述
- **skbj**：活动代号，活动的唯一标识代码

### 时间安排信息
- **stimezc**：周次，活动进行的周次范围
- **dsz**：单双周，1单周，2双周，0全周
- **jcinfo**：节次，具体节次
- **jcz**：大节，采用kxy格式

### 地点信息
- **room_DM**：活动地点代码，教室或场地的代码
- **room**：活动地点，教室或场地名称

### 分析信息
- **Analyse**：周次分析，对周次的详细分析
- **JCAnalyse**：节次分析，对节次的详细分析

## 活动类型说明

### 常见活动类型
- **学术讲座**：学术报告、专家讲座
- **学生活动**：学生社团活动、文艺演出
- **会议安排**：各类会议、研讨会
- **培训活动**：培训课程、技能训练
- **考试安排**：临时考试、补考安排
- **开放日**：学校开放日、招生宣传

### 活动性质分类
1. **教学相关**：与教学活动直接相关
2. **学术活动**：学术研讨、讲座报告
3. **学生活动**：学生社团、文体活动
4. **行政事务**：各类会议、行政安排
5. **对外交流**：对外交流活动、参观访问

## 时间格式说明

### 学年格式
- **格式示例**：2009表示2009-2010学年
- **时间范围**：通常从当年9月至次年7月

### 学期定义
| 学期代码 | 学期名称 | 时间范围 | 说明 |
|----------|----------|----------|------|
| 0 | 第一学期 | 9月-次年1月 | 秋季学期 |
| 1 | 第二学期 | 2月-7月 | 春季学期 |
| 2 | 第三学期 | 7月-8月 | 夏季学期（短学期） |

### 周次格式
- **连续周次**：1-5表示第1周到第5周
- **分段周次**：1-5,8-18表示第1-5周和第8-18周
- **单周活动**：搭配dsz=1使用，只在单周进行
- **双周活动**：搭配dsz=2使用，只在双周进行

### 节次格式
- **连续节次**：1-2表示第1-2节课
- **单节次**：3表示第3节课
- **分散节次**：1,3,5表示第1、3、5节课

### 大节格式（kxy格式）
- **格式结构**：kxy，k为前缀，x表示星期几，y表示第几大节
- **星期代码**：1-7分别表示周一到周日
- **大节编号**：1-5表示第1-5大节
- **示例**：K12表示星期一第二大节

## 活动代号说明

### 代号构成规则
- **前缀标识**：使用特定前缀区分活动类型
- **时间标识**：包含活动时间信息
- **序列编号**：确保代号的唯一性

### 代号示例
- **AC202401001**：学术活动2024年第1期001号
- **ST2024091501**：学生活动2024年9月15日01号
- **MT2024031001**：会议2024年3月10日01号

## 活动地点说明

### 地点类型
- **教室**：普通教室、阶梯教室
- **会议室**：各类会议室
- **报告厅**：学术报告厅、礼堂
- **实验室**：各类实验室
- **体育场馆**：体育馆、运动场
- **户外场地**：广场、露天场地

### 地场代码规范
- **教室代码**：使用学校统一的教室编码
- **会议室代码**：会议室的专用编码
- **特殊场地**：特殊场地的专用代码

## 数据约束

1. **主键约束**：`xn, xq_id, skbj` 组合必须唯一
2. **非空约束**：主键字段必须非空
3. **时间约束**：时间安排应符合逻辑
4. **场地约束**：场地代码应引用有效场地
5. **格式约束**：时间和节次格式应符合规范

## 索引建议

- **复合主键索引**：`xn, xq_id, skbj` - 主键自动创建唯一索引
- **活动代号索引**：`skbj` - 用于查询活动信息
- **活动名称索引**：`hdmc` - 用于按活动名称查询
- **地点索引**：`room_DM` - 用于查询场地使用情况
- **时间索引**：`stimezc, jcz` - 用于按时间查询活动
- **学期索引**：`xn, xq_id` - 用于按学期查询

## 数据关联关系

### 主要外键关联
- **场地信息表**：通过 `room_DM` 关联场地详细信息
- **活动申请表**：关联活动申请的详细信息
- **组织单位表**：关联活动主办单位信息

### 业务关联
- **学期课表表**：避免与正常课程时间冲突
- **教室资源表**：管理教室资源的使用情况
- **活动审批表**：关联活动的审批流程
- **设备使用表**：关联活动所需的设备使用

## 使用示例

### SQL查询示例

```sql
-- 查询某学期的临时活动
SELECT xn, xq_id, hdmc, stimezc, jcz, room, hdnr
FROM EDU_TEMP_ACTIVITY
WHERE xn = '2024' AND xq_id = '0'
ORDER BY stimezc, jcz;

-- 查询某场地的使用情况
SELECT hdmc, stimezc, jcz, hdnr, skbj
FROM EDU_TEMP_ACTIVITY
WHERE room_DM = 'J101' AND xn = '2024' AND xq_id = '0'
ORDER BY stimezc, jcz;

-- 查询学术讲座活动
SELECT hdmc, hdnr, stimezc, jcz, room
FROM EDU_TEMP_ACTIVITY
WHERE hdmc LIKE '%讲座%' AND xn = '2024'
ORDER BY stimezc;

-- 检测时间冲突
SELECT
    jcz,
    room,
    COUNT(*) as conflict_count,
    GROUP_CONCAT(hdmc) as conflict_activities
FROM EDU_TEMP_ACTIVITY
WHERE xn = '2024' AND xq_id = '0' AND stimezc LIKE '%1%'
GROUP BY jcz, room
HAVING COUNT(*) > 1;

-- 统计活动类型分布
SELECT
    CASE
        WHEN hdmc LIKE '%讲座%' THEN '学术讲座'
        WHEN hdmc LIKE '%会议%' THEN '会议安排'
        WHEN hdmc LIKE '%活动%' THEN '学生活动'
        WHEN hdmc LIKE '%考试%' THEN '考试安排'
        ELSE '其他活动'
    END as activity_type,
    COUNT(*) as activity_count
FROM EDU_TEMP_ACTIVITY
WHERE xn = '2024'
GROUP BY
    CASE
        WHEN hdmc LIKE '%讲座%' THEN '学术讲座'
        WHEN hdmc LIKE '%会议%' THEN '会议安排'
        WHEN hdmc LIKE '%活动%' THEN '学生活动'
        WHEN hdmc LIKE '%考试%' THEN '考试安排'
        ELSE '其他活动'
    END
ORDER BY activity_count DESC;
```

### 数据插入示例

```sql
INSERT INTO EDU_TEMP_ACTIVITY (
    xn, xq_id, hdmc, hdnr, skbj,
    stimezc, dsz, jcinfo, jcz, room_DM, room
) VALUES (
    '2024', '0', '人工智能学术讲座', 'AI技术前沿与发展趋势',
    'AC202401001', '5', '0', '3-4', 'K13',
    'R101', '报告厅101'
);
```

## 业务逻辑说明

### 活动安排流程
1. **活动申请**：提交活动申请和场地需求
2. **场地查询**：查询可用场地和时间
3. **冲突检测**：检测与其他活动的冲突
4. **审批审核**：相关部门审核批准
5. **安排确认**：确认活动安排并录入系统
6. **信息发布**：发布活动安排信息

### 冲突检测原则
1. **时间冲突**：同一时间同一场地安排多个活动
2. **课程冲突**：与正常课程时间冲突
3. **容量冲突**：活动人数超过场地容量
4. **设备冲突**：所需设备已被占用

### 优先级规则
1. **教学优先**：正常课程安排优先
2. **考试优先**：重要考试安排优先
3. **学术活动**：重要学术活动优先
4. **先申请先得**：同等优先级下先申请先得

## 数据维护建议

### 定期维护
1. **信息更新**：及时更新活动信息
2. **状态维护**：维护活动的进行状态
3. **场地维护**：维护场地信息准确性
4. **清理数据**：清理过期的活动数据

### 异常处理
1. **冲突处理**：及时处理场地和时间冲突
2. **信息错误**：纠正错误的活动信息
3. **重复安排**：检查并处理重复活动安排
4. **过期清理**：定期清理过期活动数据

### 质量控制
1. **完整性检查**：确保活动信息完整
2. **准确性检查**：确保时间和场地信息准确
3. **及时性检查**：确保活动信息及时更新
4. **合理性检查**：确保活动安排合理

---

**数据来源**：教务管理系统、活动管理系统
**维护单位**：教务处、各院系、活动中心
**更新频率**：实时更新，根据活动安排动态调整