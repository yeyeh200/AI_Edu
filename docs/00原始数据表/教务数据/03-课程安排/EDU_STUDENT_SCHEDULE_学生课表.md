# EDU_STUDENT_SCHEDULE 学生课表表

## 基本信息

- **表名**：`EDU_STUDENT_SCHEDULE`（原表名：`V_BRW_Schedule_Stud`）
- **中文名称**：学生课表
- **用途**：存储学生个人课表信息，包括学生所选课程的时间、地点、教师等详细信息
- **字段数量**：18个
- **数据类别**：教务系统 - 课程安排模块

## 字段定义

| 字段名 | 原字段名 | 数据类型 | 长度 | 是否为空 | 主键 | 默认值 | 备注 |
|--------|----------|----------|------|----------|------|--------|------|
| xn | 学年 | char | - | NO | YES | - | 如，"2009"表示2009-2010学年 |
| xq_id | 学期ID | char | - | NO | YES | - | 0第一学期，1第二学期，2第三学期 |
| user_xh | 学生学号 | char | - | NO | YES | - | - |
| XM | 学生姓名 | char | - | YES | NO | - | - |
| user_kcdm | 课程代码 | char | - | NO | YES | - | - |
| kcmc | 课程名称 | char | - | YES | NO | - | - |
| SKBJ | 上课班级 | char | - | NO | YES | - | - |
| zjjs_gh | 教师工号 | char | - | NO | YES | - | - |
| zjjs_xm | 教师姓名 | char | - | YES | NO | - | - |
| stimezc | 周次 | char | - | NO | YES | - | 如：1-5,8-18 |
| dsz | 单双周 | char | - | NO | YES | - | 1单周，2双周，0全周 |
| jcinfo | 节次 | char | - | NO | YES | - | 如：1-2 |
| jcz | 大节 | char | - | NO | YES | - | kxy格式，如K12表示星期一第二大节 |
| room | 上课地点 | char | - | NO | YES | - | - |
| Analyse | 周次分析 | char | - | YES | NO | - | - |
| JCAnalyse | 节次分析 | char | - | YES | NO | - | - |
| kclb1mc | 课程类别一 | char | - | YES | NO | - | - |
| kclb2mc | 课程类别二 | char | - | YES | NO | - | - |
| sfcx | 是否重修 | char | - | YES | NO | - | - |
| cdate | 选课时间 | datetime | - | YES | NO | - | - |

## 字段详细说明

### 主键字段
- **xn**：学年，主键组成部分
- **xq_id**：学期ID，主键组成部分
- **user_xh**：学生学号，主键组成部分
- **user_kcdm**：课程代码，主键组成部分
- **SKBJ**：上课班级，主键组成部分
- **zjjs_gh**：教师工号，主键组成部分
- **stimezc**：周次，主键组成部分
- **dsz**：单双周，主键组成部分
- **jcinfo**：节次，主键组成部分
- **jcz**：大节，主键组成部分
- **room**：上课地点，主键组成部分

### 学生信息字段
- **user_xh**：学生学号，学生的唯一标识
- **XM**：学生姓名，学生姓名

### 课程信息字段
- **user_kcdm**：课程代码，课程的标准代码
- **kcmc**：课程名称，课程的中文名称
- **SKBJ**：上课班级，教学班的编号
- **kclb1mc**：课程类别一，课程的一级分类
- **kclb2mc**：课程类别二，课程的二级分类

### 教师信息字段
- **zjjs_gh**：教师工号，任课教师的工号
- **zjjs_xm**：教师姓名，任课教师姓名

### 时间安排字段
- **stimezc**：周次，上课的周次范围
- **dsz**：单双周，1单周，2双周，0全周
- **jcinfo**：节次，具体节次
- **jcz**：大节，采用kxy格式

### 地点信息字段
- **room**：上课地点，教室名称

### 分析和选课信息
- **Analyse**：周次分析，对周次的详细分析
- **JCAnalyse**：节次分析，对节次的详细分析
- **sfcx**：是否重修，标识是否为重修课程
- **cdate**：选课时间，学生选择该课程的时间

## 课程类别说明

### 课程类别一（kclb1mc）分类
- **公共基础课**：全校性基础课程
- **学科基础课**：专业基础理论课程
- **专业核心课**：专业核心理论课程
- **专业选修课**：专业方向选修课程
- **通识选修课**：通识教育选修课程

### 课程类别二（kclb2mc）分类
- **必修课程**：专业必选课程
- **选修课程**：学生自主选择课程
- **限选课程**：指定范围内选择
- **任选课程**：无限制选择

### 重修标识（sfcx）
| 标识值 | 说明 | 含义 |
|--------|------|------|
| 1 | 是 | 该课程为重修 |
| 0 | 否 | 该课程为正常修读 |
| NULL | 未知 | 重修状态未明确 |

## 选课时间说明

### 选课时间记录
- **记录格式**：YYYY-MM-DD HH:MM:SS
- **记录时机**：学生确认选课时记录
- **时间精度**：精确到秒
- **时区**：使用服务器本地时间

### 选课时间用途
1. **选课顺序**：记录选课的时间顺序
2. **优先级**：某些选课可能按时间优先
3. **统计分析**：用于选课行为分析
4. **问题追溯**：出现问题时可追溯时间

## 时间格式说明

### 学年格式
- **格式示例**：2009表示2009-2010学年
- **时间范围**：通常从当年9月至次年7月

### 学期定义
| 学期代码 | 学期名称 | 时间范围 | 说明 |
|----------|----------|----------|------|
| 0 | 第一学期 | 9月-次年1月 | 秋季学期 |
| 1 | 第二学期 | 2月-7月 | 春季学期 |
| 2 | 第三学期 | 7月-8月 | 夏季学期（短学期） |

### 周次格式
- **连续周次**：1-5表示第1周到第5周
- **分段周次**：1-5,8-18表示第1-5周和第8-18周
- **单周安排**：搭配dsz=1使用，只在单周上课
- **双周安排**：搭配dsz=2使用，只在双周上课

### 节次格式
- **连续节次**：1-2表示第1-2节课
- **单节次**：3表示第3节课
- **分散节次**：1,3,5表示第1、3、5节课

### 大节格式（kxy格式）
- **格式结构**：kxy，k为前缀，x表示星期几，y表示第几大节
- **星期代码**：1-7分别表示周一到周日
- **大节编号**：1-5表示第1-5大节
- **示例**：K12表示星期一第二大节

## 数据约束

1. **主键约束**：复合主键必须唯一
2. **非空约束**：主键字段必须非空
3. **外键约束**：学号、课程代码、教师工号应引用有效记录
4. **时间约束**：选课时间应符合合理的时间范围
5. **检查约束**：重修标识应为有效值

## 索引建议

- **复合主键索引**：`xn, xq_id, user_xh, user_kcdm, jcz` - 主键自动创建唯一索引
- **学号索引**：`user_xh` - 用于查询学生课表
- **课程索引**：`user_kcdm` - 用于查询课程选课情况
- **教师索引**：`zjjs_gh` - 用于查询教师授课学生
- **时间索引**：`cdate` - 用于按选课时间查询
- **班级索引**：`SKBJ` - 用于按上课班级查询
- **重修索引**：`sfcx` - 用于查询重修课程

## 数据关联关系

### 主要外键关联
- **学生信息表**：通过 `user_xh` 关联学生基本信息
- **课程信息表**：通过 `user_kcdm` 关联课程详细信息
- **教师信息表**：通过 `zjjs_gh` 关联教师基本信息
- **班级信息表**：通过 `SKBJ` 关联班级详细信息

### 业务关联
- **学期课表表**：关联班级的统一课表
- **学生成绩表**：关联学生的课程成绩
- **选课记录表**：关联学生的选课操作记录
- **考试安排表**：关联学生的考试安排

## 使用示例

### SQL查询示例

```sql
-- 查询某学生的完整课表
SELECT xn, xq_id, kcmc, stimezc, jcz, room, zjjs_xm, SKBJ
FROM EDU_STUDENT_SCHEDULE
WHERE user_xh = '2024001' AND xn = '2024' AND xq_id = '0'
ORDER BY jcz, stimezc;

-- 查询某课程的选课学生名单
SELECT user_xh, XM, SKBJ, sfcx, cdate
FROM EDU_STUDENT_SCHEDULE
WHERE user_kcdm = 'CS001' AND xn = '2024' AND xq_id = '0'
ORDER BY cdate;

-- 查询重修课程
SELECT user_xh, XM, kcmc, SKBJ, zjjs_xm
FROM EDU_STUDENT_SCHEDULE
WHERE sfcx = '1' AND xn = '2024' AND xq_id = '0'
ORDER BY kcmc, user_xh;

-- 查询学生选课时间统计
SELECT
    user_xh,
    XM,
    COUNT(*) as course_count,
    MIN(cdate) as first_selection,
    MAX(cdate) as last_selection
FROM EDU_STUDENT_SCHEDULE
WHERE xn = '2024' AND xq_id = '0'
GROUP BY user_xh, XM
ORDER BY course_count DESC;

-- 查询课程类别分布
SELECT
    kclb1mc,
    kclb2mc,
    COUNT(*) as student_count,
    COUNT(DISTINCT user_xh) as unique_students
FROM EDU_STUDENT_SCHEDULE
WHERE xn = '2024' AND xq_id = '0' AND kclb1mc IS NOT NULL
GROUP BY kclb1mc, kclb2mc
ORDER BY student_count DESC;

-- 检测学生课表时间冲突
SELECT
    user_xh,
    XM,
    jcz,
    COUNT(*) as conflict_count,
    GROUP_CONCAT(kcmc) as conflict_courses
FROM EDU_STUDENT_SCHEDULE
WHERE xn = '2024' AND xq_id = '0' AND stimezc LIKE '%1%'
GROUP BY user_xh, XM, jcz
HAVING COUNT(*) > 1;
```

### 数据插入示例

```sql
INSERT INTO EDU_STUDENT_SCHEDULE (
    xn, xq_id, user_xh, XM, user_kcdm, kcmc,
    SKBJ, zjjs_gh, zjjs_xm, stimezc, dsz,
    jcinfo, jcz, room, sfcx, cdate
) VALUES (
    '2024', '0', '2024001', '张三', 'CS001', '数据结构',
    'CS202401', 'T001', '李老师', '1-16', '0',
    '1-2', 'K11', '教101', '0', '2024-02-01 09:00:00'
);
```

## 业务逻辑说明

### 选课流程
1. **选课开放**：系统开放选课功能
2. **学生选课**：学生选择课程并提交
3. **时间记录**：记录选课的具体时间
4. **选课确认**：确认选课结果
5. **课表生成**：根据选课结果生成个人课表

### 重修管理
1. **重修资格**：确定学生是否具备重修资格
2. **重修申请**：学生提交重修申请
3. **重修审核**：审核重修申请
4. **重修记录**：在课表中标记重修课程
5. **重修统计**：统计重修情况

### 课表生成
1. **数据整合**：整合选课数据和课表数据
2. **个人课表**：生成每个学生的个人课表
3. **冲突检测**：检测时间冲突并通知学生
4. **课表发布**：发布最终的个人课表

## 数据维护建议

### 定期维护
1. **数据同步**：及时同步选课和课表数据
2. **信息更新**：更新学生和课程信息
3. **冲突处理**：及时处理时间冲突
4. **数据备份**：定期备份课表数据

### 异常处理
1. **重复记录**：检查并处理重复的课表记录
2. **时间冲突**：检测并处理学生时间冲突
3. **信息错误**：纠正错误的课表信息
4. **选课异常**：处理选课过程中的异常情况

### 质量控制
1. **完整性检查**：确保课表信息完整
2. **一致性检查**：确保选课和课表数据一致
3. **准确性检查**：确保课表安排准确
4. **及时性检查**：确保数据及时更新

---

**数据来源**：教务管理系统、选课系统
**维护单位**：教务处、各院系教学秘书
**更新频率**：选课期间实时更新，课表确定后定期维护