# EDU_CALENDAR 校历数据表

## 基本信息

- **表名**：`EDU_CALENDAR`（原表名：`V_BRW_XL`）
- **中文名称**：校历数据
- **用途**：存储学校校历信息，包括教学安排、节假日、工作日等时间信息
- **字段数量**：7个
- **数据类别**：教务系统 - 课程安排模块

## 字段定义

| 字段名 | 原字段名 | 数据类型 | 长度 | 是否为空 | 主键 | 默认值 | 备注 |
|--------|----------|----------|------|----------|------|--------|------|
| xn | 学年 | char | - | YES | NO | - | 四位 |
| xqid | 学期 | char | - | YES | NO | - | 0第一学期，1第二学期，2第三学期 |
| jxz | 教学周 | char | - | YES | NO | - | 17周显示格式17 |
| rq | 日期 | char | - | YES | NO | - | 格式YYYYMMDD |
| week | 星期 | char | - | YES | NO | - | 表示星期几 |
| sfgzr | 是否工作日 | char | - | YES | NO | - | - |
| sffdjjr | 是否法定节假日 | char | - | YES | NO | - | - |

## 字段详细说明

### 学期信息字段
- **xn**：学年，四位数字表示，如2024
- **xqid**：学期，学期标识代码
- **jxz**：教学周，教学周次编号，如17表示第17周

### 日期时间字段
- **rq**：日期，具体日期，格式为YYYYMMDD
- **week**：星期，表示星期几

### 日历属性字段
- **sfgzr**：是否工作日，标识是否为工作日
- **sffdjjr**：是否法定节假日，标识是否为法定节假日

## 学期信息说明

### 学年格式
- **格式标准**：四位数字，如2024表示2024-2025学年
- **时间范围**：通常从当年9月至次年7月
- **命名规则**：使用学年的起始年份

### 学期定义
| 学期代码 | 学期名称 | 时间范围 | 说明 |
|----------|----------|----------|------|
| 0 | 第一学期 | 9月-次年1月 | 秋季学期 |
| 1 | 第二学期 | 2月-7月 | 春季学期 |
| 2 | 第三学期 | 7月-8月 | 夏季学期（短学期） |

### 教学周说明
- **周次编号**：1、2、3...依次编号
- **显示格式**：直接显示周次数字，如17表示第17周
- **学期分布**：通常第一学期18周，第二学期18周
- **特殊安排**：可能包含考试周、实践周等特殊安排

## 日期格式说明

### 标准格式
- **格式规范**：YYYYMMDD
- **示例**：20240115表示2024年1月15日
- **优势**：便于排序和比较
- **国际标准**：符合日期表示的国际标准

### 日期组成
- **YYYY**：四位年份
- **MM**：两位月份（01-12）
- **DD**：两位日期（01-31）

## 星期说明

### 星期编码
| 星期代码 | 星期名称 | 英文名称 | 说明 |
|----------|----------|----------|------|
| 1 | 星期一 | Monday | 一周的第一天 |
| 2 | 星期二 | Tuesday | 一周的第二天 |
| 3 | 星期三 | Wednesday | 一周的第三天 |
| 4 | 星期四 | Thursday | 一周的第四天 |
| 5 | 星期五 | Friday | 一周的第五天 |
| 6 | 星期六 | Saturday | 一周的第六天 |
| 7 | 星期日 | Sunday | 一周的第七天 |

## 工作日标识说明

### 是否工作日（sfgzr）
| 标识值 | 说明 | 含义 |
|--------|------|------|
| 1 | 是 | 该日期为工作日 |
| 0 | 否 | 该日期为非工作日 |

### 工作日定义
1. **标准工作日**：周一至周五
2. **调休工作日**：周末调整为工作日
3. **特殊工作日**：因特殊情况安排的工作日
4. **非工作日**：周末、节假日等

## 法定节假日说明

### 是否法定节假日（sffdjjr）
| 标识值 | 说明 | 含义 |
|--------|------|------|
| 1 | 是 | 该日期为法定节假日 |
| 0 | 否 | 该日期非法定节假日 |

### 法定节假日类型
1. **国家法定节假日**：
   - 元旦：1月1日
   - 春节：农历正月初一
   - 清明节：4月4日或5日
   - 劳动节：5月1日
   - 端午节：农历五月初五
   - 中秋节：农历八月十五
   - 国庆节：10月1日

2. **学校特色节假日**：
   - 校庆日
   - 地方特色节日
   - 学校特殊安排日

## 校历结构说明

### 学年校历组成
```
学年校历 = 第一学期 + 寒假 + 第二学期 + 暑假 [+ 第三学期]
```

### 第一学期结构
- **开学前准备**：1-2周
- **教学周**：16-17周
- **考试周**：1-2周
- **学期结束**：1周

### 第二学期结构
- **开学前准备**：1周
- **教学周**：16-17周
- **考试周**：1-2周
- **学期结束**：1周

### 假期安排
- **寒假**：1-2月，约4-6周
- **暑假**：7-8月，约6-8周
- **其他假期**：根据节假日安排

## 数据约束

1. **主键约束**：`rq` 字段应保持唯一性
2. **格式约束**：`rq` 字段必须符合YYYYMMDD格式
3. **检查约束**：`sfgzr` 和 `sffdjjr` 只能是0或1
4. **范围约束**：`week` 应在1-7范围内
5. **逻辑约束**：法定节假日通常不是工作日

## 索引建议

- **主键索引**：`rq` - 建议创建唯一索引，确保日期唯一性
- **学年索引**：`xn` - 用于按学年查询
- **学期索引**：`xqid` - 用于按学期查询
- **教学周索引**：`jxz` - 用于按教学周查询
- **工作日索引**：`sfgzr` - 用于筛选工作日
- **节假日索引**：`sffdjjr` - 用于筛选节假日
- **星期索引**：`week` - 用于按星期查询

## 数据关联关系

### 业务关联
- **学期课表表**：根据校历确定教学安排时间
- **考试安排表**：根据校历安排考试时间
- **活动安排表**：根据校历安排各类活动
- **假期管理表**：管理各类假期安排

### 应用系统
- **课表系统**：依赖校历进行课表编排
- **选课系统**：根据校历开放选课时间
- **考试系统**：按照校历安排考试时间
- **请假系统**：根据校历审核请假时间

## 使用示例

### SQL查询示例

```sql
-- 查询某学年的校历
SELECT xn, xqid, jxz, rq, week, sfgzr, sffdjjr
FROM EDU_CALENDAR
WHERE xn = '2024'
ORDER BY rq;

-- 查询某学期的工作日
SELECT rq, week, jxz
FROM EDU_CALENDAR
WHERE xqid = '0' AND xn = '2024' AND sfgzr = '1'
ORDER BY rq;

-- 查询法定节假日
SELECT rq, week, jxz, xqid
FROM EDU_CALENDAR
WHERE sffdjjr = '1' AND xn = '2024'
ORDER BY rq;

-- 统计学期工作日数量
SELECT
    xn,
    xqid,
    COUNT(*) as total_days,
    SUM(CASE WHEN sfgzr = '1' THEN 1 ELSE 0 END) as work_days,
    SUM(CASE WHEN sffdjjr = '1' THEN 1 ELSE 0 END) as holiday_days
FROM EDU_CALENDAR
WHERE xn = '2024'
GROUP BY xn, xqid
ORDER BY xqid;

-- 查询某月的校历安排
SELECT rq, week, jxz, sfgzr, sffdjjr,
       CASE
           WHEN sffdjjr = '1' THEN '法定节假日'
           WHEN sfgzr = '1' THEN '工作日'
           ELSE '休息日'
       END as day_type
FROM EDU_CALENDAR
WHERE rq LIKE '202401%' AND xn = '2024'
ORDER BY rq;

-- 查询教学周分布
SELECT
    jxz,
    COUNT(*) as day_count,
    MIN(rq) as start_date,
    MAX(rq) as end_date
FROM EDU_CALENDAR
WHERE xn = '2024' AND xqid = '0' AND jxz IS NOT NULL
GROUP BY jxz
ORDER BY jxz;
```

### 数据插入示例

```sql
INSERT INTO EDU_CALENDAR (
    xn, xqid, jxz, rq, week, sfgzr, sffdjjr
) VALUES (
    '2024', '0', '1', '20240902', '1', '1', '0'
);
```

### 数据更新示例

```sql
-- 更新为法定节假日
UPDATE EDU_CALENDAR
SET sffdjjr = '1', sfgzr = '0'
WHERE rq = '20241001';

-- 更新为调休工作日
UPDATE EDU_CALENDAR
SET sfgzr = '1', sffdjjr = '0'
WHERE rq = '20240928';
```

## 业务逻辑说明

### 校历制定流程
1. **学年规划**：确定学年整体安排
2. **学期划分**：划分学期和假期
3. **教学周安排**：安排教学周次
4. **节假日标注**：标注法定节假日
5. **调休安排**：安排调休工作日
6. **审核发布**：审核并发布校历

### 校历调整原则
1. **法定优先**：优先保证法定节假日
2. **教学为本**：确保教学时间充足
3. **科学合理**：安排要科学合理
4. **提前公布**：提前公布便于安排

### 工作日计算规则
1. **基础工作日**：周一至周五为工作日
2. **调休处理**：根据国家调休安排调整
3. **特殊安排**：学校特殊需要的工作日
4. **教学相关**：教学相关活动的特殊安排

## 数据维护建议

### 定期维护
1. **年度更新**：每年更新学年校历
2. **节假日调整**：根据国家规定调整节假日
3. **调休更新**：及时更新调休安排
4. **特殊标注**：标注特殊日期和活动

### 异常处理
1. **重复日期**：检查并处理重复日期记录
2. **格式错误**：纠正错误的日期格式
3. **逻辑错误**：处理工作日和节假日的逻辑冲突
4. **缺失数据**：补充缺失的校历数据

### 质量控制
1. **完整性检查**：确保校历数据完整
2. **准确性检查**：确保日期信息准确
3. **一致性检查**：确保相关数据一致
4. **及时性检查**：确保校历及时更新

---

**数据来源**：教务管理系统、校历管理系统
**维护单位**：教务处、学校办公室
**更新频率**：年度更新，节假日调整时及时更新